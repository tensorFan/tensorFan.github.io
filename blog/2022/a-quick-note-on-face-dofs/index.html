<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Home | A not so quick note on implementing face degrees of freedom, and degrees of freedom in general</title>
<meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design.
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<!-- <link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" /> -->
<link rel="stylesheet" href="https://combinatronics.io/jwarby/pygments-css/master/github.css" />

<!-- Styles -->

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üìú</text></svg>">

<link rel="stylesheet" href="/assets/css/main.css">
<link rel="canonical" href="/blog/2022/a-quick-note-on-face-dofs/">

<!-- JQuery -->
<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>


<!-- Theming-->

<script src="/assets/js/theme.js"></script>
<script src="/assets/js/dark_mode.js"></script>






    
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  </head>

  <body class="fixed-top-nav ">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="https://tensorfan.github.io//">
       Home
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              about
              
            </a>
          </li>
          
          <!-- Blog -->
          <li class="nav-item active">
            <a class="nav-link" href="/blog/">
              blog
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/publications/">
                papers
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/projects/">
                research activities
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/teaching/">
                teaching
                
              </a>
          </li>
          
          
          
            <div class = "toggle-container">
              <a id = "light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      

<div class="post">

  <header class="post-header">
    <h1 class="post-title">A not so quick note on implementing face degrees of freedom, and degrees of freedom in general</h1>
    <p class="post-meta">August 22, 2022</p>
  </header>

  <article class="post-content">
    <p>Coming from an introductory course on FEM, a student may not (depending on the course) have encountered any finite element outside of the Lagrange family. This kind of element has a corresponding set of degrees of freedom (DOFs) being the nodal evaluations of a function (or for higher order also the nodal values of the derivatives of said function.) Recall that the basis functions \(\{\varphi_i\}_{i=1}^n\) are those functions which evaluate to the kronecker delta on the DOFs,
\begin{equation} dof_j(\varphi_i) = \delta_{ij}. \end{equation}
Here \(n\) is the dimension of the finite dimensional space in which we search for a discrete solution to some variational problem. In the case of the Lagrange family of order 1, the basis functions of an element are its barycentric coordinates.</p>

<p>Note here that the DOFs can be almost any type of functional, they are not restricted to being just nodal evaluations. Then the basis functions will change accordingly, and so will the space that they span. In fact, this is a general definition of a finite element which I am quite fond of. There are exceptions but it covers most if not all finite elements one can encounter. I like the following (slightly simplified) version from Ciarlet‚Äôs book <a href="https://books.google.se/books/about/The_Finite_Element_Method_for_Elliptic_P.html?id=1PF-WS0Nl9IC&amp;source=kp_book_description&amp;redir_esc=y">‚ÄúThe Finite Element Method for Elliptic Problems‚Äù</a></p>

<p>A finite element is a triple \((K,P,\Sigma)\) where \(K\) is a subset of \(\mathbb{R}^n\), \(P\) is some set of \(\mathbb{R}^k\)-valued functions (\(k\leq n\)) on \(K\), and \(\Sigma\) is a finite set of linearly independent linear forms \(\phi_i, 1\leq i\leq N\) acting on \(P\). Furthermore we assume that there exists functions \(\varphi_j\) in \(P\) for which \(\phi_i(\varphi_j)=\delta_{ij}\). In other words we assume that \(P=\Sigma'\) the linear dual space of \(\Sigma\). This last property is also called \(P-\)unisolvency in the FEM literature. What‚Äôs so nice about this definition is that if you have \(K\) in the back of your mind as a triangle or quadrilateral, the element is entirely determined by how you choose \(\Sigma\).</p>

<p>Okay, this was a tangent but now the reader knows that there are more elements out there than just the Lagrange element. See <a href="https://www-users.cse.umn.edu/~arnold/femtable/">this link</a> for a cute table. The Lagrange element of order \(k\) on geometry \(K\) is usually denoted \(P_k(K)\). In every case I have seen, the DOFs in \(\Sigma\) are inherently tied to the geometry of the element \(K\), which is interesting in and of itself.. but another example is given by the Raviart-Thomas family. This will lead us to what I really wanted to discuss here. I guess at this point I should change the title of this post..</p>

<p>The degrees of freedom of the lowest order member of the Raviart-Thomas family (RT family for short) are associated to the faces \(F\) of \(K\) and are given by 
\begin{equation} dof_F(\pmb{\varphi}) = \int_F \pmb{\varphi}\cdot \pmb{n}. \end{equation}
We see directly that \(k=2\) here. In words, we just integrate the normal component of our vector-valued input on the face \(F\). The RT element is very useful for certain applications in which the divergence is involved as a differential operator (can you figure out why? Hint: multivariate integration by parts!)</p>

<p>Let‚Äôs go to higher order. The RT element of order 1, \(RT_1\), is defined by the following DOFs
\begin{equation}\label{eq:1}
dof_{F,\psi}(\pmb{\varphi})=\int_F \pmb{\varphi}\cdot\pmb{n} \psi, \ \forall \psi\in P_1(F)
\end{equation}
\begin{equation}\label{eq:2}
dof_{\pmb{p}}(\pmb{\varphi})=\int_K \pmb{\varphi}\cdot \pmb{p}, \ \forall \pmb{p}\in P_0(K)
\end{equation}</p>

<p>A good warmup is to consider \eqref{eq:2}. It is integrating \(\pmb{\varphi}\) against every vector-valued constant function, and there are only two (one for each component) up to linear independence. Thus we see that \eqref{eq:2} is equivalent to two DOFs, each integrating a component of \(\pmb{\varphi}\) over \(K\). Looking now at \eqref{eq:1}, we see that there are several DOFs per face, the amount of which is equal to the dimension of \(P_1(F)\). Since \(F\) is a piece of the geometry of 1 dimension, the barycentric coordinates are at most 2, one for each node. But in fact \(P_k(K)\) is exactly the whole space of polynomials of degree less than or equal to \(k\) on \(K\), so any basis we can think of will work to span \(P_1(F)\). Thus we have ambiguity when it comes to implementation!</p>

<p>The basis we choose matters because the corresponding basis functions of \(RT_1\) must change according to our choice, and they might even scale differently! It might have other consequences too. We can choose the naive basis \(\{1,x\}\) on our faces, in which case the subset of basis functions corresponding to the DOFs with \(\psi=1\) will be precisely the \(RT_0\) basis functions. This can be useful if you are for some reason wanting to use these basis functions / DOFs for a special purpose in your code. If your basis is something else, you can still construct them of course, but it might take a lot of work. <a href="https://defelement.com/elements/raviart-thomas.html">Here</a> is a wonderful site where you can view a database of different finite elements.</p>

  </article>

  

</div>

    </div>

    <!-- Footer -->

    
<footer class="fixed-bottom">
  <div class="container mt-0">
    &copy; Copyright 2025 Erik A. Nilsson.
    
    
    
  </div>
</footer>



  </body>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Medium Zoom JS -->
<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
<script src="/assets/js/zoom.js"></script>


<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>


</html>
